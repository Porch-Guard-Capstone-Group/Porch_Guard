"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t,r=e(require("express")),n=require("firebase-functions"),o=e(require("glob")),s=require("path");function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(t=exports.RequestType||(exports.RequestType={})).GET="GET",t.POST="POST",t.PUT="PUT",t.DELETE="DELETE",t.PATCH="PATCH";var p=function(e,t,r){if(this.name=e,this.requestType=t,this.handler=r,!r)throw new Error("Please provide a endpoint request handler.");this.name=e,this.handler=r,this.requestType=t},a=function(e){function t(t){return e.call(this,void 0,exports.RequestType.GET,t)||this}return u(t,e),t}(p),c=function(e){function t(t){return e.call(this,void 0,exports.RequestType.POST,t)||this}return u(t,e),t}(p),d=function(e){function t(t){return e.call(this,void 0,exports.RequestType.PUT,t)||this}return u(t,e),t}(p),h=function(e){function t(t){return e.call(this,void 0,exports.RequestType.DELETE,t)||this}return u(t,e),t}(p),l=function(e){function t(t){return e.call(this,void 0,exports.RequestType.PATCH,t)||this}return u(t,e),t}(p),f=console.log,T=function(){function e(e,t,r,n,o){if(void 0===r&&(r=!0),void 0===n&&(n=!0),void 0===o&&(o=!0),!e)throw new Error("rootPath is required to find the functions.");this.rootPath=e,this.exports=t,r&&this.buildReactiveFunctions(o),n&&this.buildRestfulApi(o)}var t=e.prototype;return t.buildReactiveFunctions=function(e){var t=this;f("Reactive Functions - Building..."),o.sync(this.rootPath+"/**/*.function.js",{cwd:this.rootPath,ignore:"./node_modules/**"}).forEach((function(r){var n=s.parse(r),o=n.dir.split("/"),u=e?o[o.length-2]||"":o[o.length-1]||"",p=n.name.replace(".function","");process.env.FUNCTION_NAME&&process.env.FUNCTION_NAME!==p||(t.exports[u]||(t.exports[u]={}),f("Reactive Functions - Added "+u+"/"+p),t.exports[u]=i({},t.exports[u],require(r)))})),f("Reactive Functions - Built")},t.buildRestfulApi=function(e){var t=this;f("Restful Endpoints - Building...");var u=o.sync(this.rootPath+"/**/*.endpoint.js",{cwd:this.rootPath,ignore:"./node_modules/**"}),p=r(),a=new Map;u.forEach((function(o){var u=s.parse(o).dir.split("/"),c=e?u[u.length-2]||"":u[u.length-1]||"",d=a.get(c);d||(d=r.Router(),a.set(c,d));try{t.buildEndpoint(o,c,d)}catch(e){throw new Error("Restful Endpoints - Failed to add the endpoint defined in "+o+" to the "+c+" Api.")}p.use("/",d),t.exports[c]=i({},t.exports[c],{api:n.https.onRequest(p)})})),f("Restful Endpoints - Built")},t.buildEndpoint=function(e,t,r){var n=s.parse(e),o=require(e).default,i=o.name||n.name.replace(".endpoint",""),u=o.handler;switch(o.requestType){case exports.RequestType.GET:r.get("/"+i,u);break;case exports.RequestType.POST:r.post("/"+i,u);break;case exports.RequestType.PUT:r.put("/"+i,u);break;case exports.RequestType.DELETE:r.delete("/"+i,u);break;case exports.RequestType.PATCH:r.patch("/"+i,u);break;default:throw new Error("A unsupported RequestType was defined for a Endpoint.\n\n          Please make sure that the Endpoint file exports a RequestType\n          using the constants in src/system/constants/requests.ts.\n\n          **This value is required to add the Endpoint to the API**")}f("Restful Endpoints - Added "+t+"/"+o.requestType+":"+i)},e}();exports.Delete=h,exports.Endpoint=p,exports.FunctionParser=T,exports.Get=a,exports.Patch=l,exports.Post=c,exports.Put=d;
//# sourceMappingURL=firebase-backend.cjs.production.min.js.map
